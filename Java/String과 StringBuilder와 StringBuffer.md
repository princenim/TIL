# **ğŸ“Œ**Â Stringê³¼ StringBuilderì™€ StringBuffer

`String`ê³¼ `StringBuider`ì™€ `StringBeffer`ì€ ëª¨ë‘ ìë°”ì˜ ë¬¸ìì—´ í´ë˜ìŠ¤ì´ë‹¤. í•˜ì§€ë§Œ êµ³ì´ ì—¬ëŸ¬ê°€ì§€ë¥¼ ë§Œë“¤ì–´ ë†“ì€ ì´ìœ ê°€ ë¬´ì—‡ì¼ê¹Œ?

# 1. String

`String`ê³¼ ë‹¤ë¥¸ ë‘ `StringBuffer`,`StringBilder`ì˜ í° ì°¨ì´ì ì€ ë°”ë¡œ `String`ì€ `ë¶ˆë³€ê°ì²´ë¼ëŠ”` ê²ƒì´ë‹¤.  ë¶ˆë³€ê°ì²´ë€ `Immuatble` ì´ë¼ëŠ” ì˜ë¯¸ë¡œ ë§ ê·¸ëŒ€ë¡œ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ì˜ë¯¸ë¡œ ê°ì²´ê°€ ìƒì„±ëœ í›„ ë‚´ë¶€ì˜ ìƒíƒœê°€ ë³€í•˜ì§€ ì•Šê³  ê³„ì† ìœ ì§€ë˜ëŠ” ê°ì²´ë¥¼ ë§í•œë‹¤. ë”°ë¼ì„œ + ì—°ì‚°ì´ë‚˜ concat ë©”ì†Œë“œë¥¼ ì‚¬ìš©í• ë•Œ ë©”ëª¨ë¦¬ìƒì— ê¸°ì¡´ì— ìƒì„±ëœ `String`ê°ì²´ ë¬¸ìì—´ì— ë‹¤ë¥¸ ë¬¸ìì—´ì„ ë¶™ì—¬ë„ ê¸°ì¡´ ë¬¸ìì—´ì— ìƒˆë¡œìš´ ë¬¸ìì—´ì´ ë¶™ëŠ”ë°ê°€ ì•„ë‹ˆë¼ ìƒˆë¡œìš´ String ê°ì²´ë¥¼ ë§Œë“ í›„ ìƒˆ `String` ê°ì²´ì— ë‹¤ë¥¸ ë¬¸ìì—´ì„ ì—°ê²°í•˜ê³  ê·¸ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ë„ë¡ í•œë‹¤.

ì°¸ê³ ë¡œ `String ë¦¬í„°ëŸ´`ê³¼ `new`ë¥¼ ì´ìš©í•œ ìŠ¤íŠ¸ë§ ê°ì²´ ìƒì„± ë°©ë²• ì¡´ì¬í•œë‹¤. ë‘˜ë‹¤ `heap`ì˜ì—­ì— ì €ì¥ë˜ë‚˜ ë¦¬í„°ëŸ´ì€ `heap` ì˜ì—­ì˜ `String constant pool`ì˜ì—­ì— ì €ì¥ëœë‹¤.

ë”°ë¼ì„œ ë‚´ë¶€ì ìœ¼ë¡œ ê³„ì† ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ê¸°ë•Œë¬¸ì— ë¬¸ìì—´ ì—°ì‚°ì´ ë§ì€ ê²½ìš°ì—ëŠ” ì„±ëŠ¥ì´ ì¢‹ì§€ì•Šë‹¤. ì´ëŸ° ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë“±ì¥í•œ ê²ƒì´ `StringBuffuer`ê³¼ `StringBuilder`ì´ë‹¤.



## 1.2 Stringì´ ë¶ˆë³€ê°ì²´ì¸ì´ìœ 

í•˜ì§€ë§Œ ì™œ ìë°”ëŠ” Stringì„ ë¶ˆë³€ê°ì²´ë¡œ ë§Œë“¤ì—ˆì„ê¹Œ?

1. **`ë³´ì•ˆ ë° ì•ˆì „`** : Stringì€ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë§ì´ ì‚¬ìš©ëœë‹¤. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì‹œì˜ Host,Portì˜ ì •ë³´ë‚˜ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ ê²½ë¡œ ì •ë³´ë“±ì„ Stringìœ¼ë¡œ ì €ì¥í•œë‹¤. ë”°ë¼ì„œ ë§Œì•½ì— Stringì´ ë¶ˆë³€í•˜ì§€ ì•Šê³  mutableí• ë•Œ ë©”ì†Œë“œì˜ í˜¸ì¶œìì— ì˜í•´ ê°’ì´ ì–¸ì œë“  ë°”ë€” ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë³´ì•ˆìƒì˜ ì·¨ì•½ì ì„ ê°–ê²Œëœë‹¤.
2. **`ë™ê¸°í™”(synchronization)`**  : ë¶ˆë³€ê°ì²´ëŠ” ê°’ì´ ë°”ë€Œì§€ ì•Šê¸°ë•Œë¬¸ì— ë©€í‹°ì“°ë ˆë“œ í™˜ê²½ì—ì„œ `Thread-safe`í•˜ë‹¤.  ì“°ë ˆë“œê°€ ê°’ì„ ë³€ê²½í•˜ë©´ ë™ì¼í•œ `String`ì„ ìˆ˜ì •í•˜ì§€ ì•Šê³  `String constant pool`ì— ìƒˆ ë¬¸ìì—´ì´ ìƒê¸°ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ë©€í‹° ì“°ë ˆë“œ í™˜ê²½ì—ì„œ ì•ˆì •ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.
3. **`ì„±ëŠ¥`** : Stringì€ ë¦¬í„°ëŸ´ë¡œ ê°ì²´ë¥¼ ë§Œë“¤ì—ˆì„ë•Œ ê°’ì„ String constant poolì— ì €ì¥í•œë‹¤. ê·¸ë¦¬ê³  ê°™ì€ ë¬¸ìì—´ì´ ìˆëŠ”ì§€ ë¨¼ì € String constant poolì—ì„œ í™•ì¸ì„ í•˜ê³  ì—†ìœ¼ë©´ ìƒˆë¡œìš´ String ê°ì²´ë¥¼ String constant poolì— ë§Œë“¤ê³  ìˆìœ¼ë©´ ê¸°ì¡´ì˜ Stringì˜ ì£¼ì†Œê°’ì„ ë°˜í™˜í•œë‹¤. ì´ë ‡ê²Œ ë¬¸ìì—´ ë¦¬í„°ëŸ´ì„ ìºì‹±í•˜ê³  ì¬ì‚¬ìš©í•˜ë©´ í™ ê³µê°„ì„ ë§ì´ ì ˆì•½í•  ìˆ˜ ìˆë‹¤.

   í•˜ì§€ë§Œ ì´ë•Œ Stringì´ ë¶ˆë³€ê°ì²´ê°€ ì•„ë‹ˆë©´ì„œ String constant poolì„ ì‚¬ìš©í•œë‹¤ë©´ ê¸°ì¡´ì˜ ë¬¸ìì—´ ê°’ì„ ìˆ˜ì •í•´ì„œ ë¬¸ìì—´ì˜ ê°’ì´ ë‹¬ë¼ì§„ë‹¤ë©´ ê°™ì€ ê°ì²´ë¥¼ ë°”ë¼ë³´ëŠ” ë‹¤ë¥¸ ì°¸ì¡°ë³€ìˆ˜ë“¤ë„ ë°”ë€ ê°’ì„ ë°”ë¼ë³´ê²Œ ëœë‹¤. ì´ëŠ” ë§ë„ ì•ˆë˜ëŠ” ê²ƒì´ë¯€ë¡œ Stringì€ ë¶ˆë³€ê°ì²´ì¼ìˆ˜ ë°–ì— ì—†ë‹¤.


# 2. StringBufferì™€ StringBuilder

ë‘ í´ë˜ìŠ¤ëŠ” String í´ë˜ìŠ¤ì™€ ë‹¤ë¥´ê²Œ `ê°€ë³€(mutable)` ê°ì²´ì´ë‹¤. ê°ì²´ì˜ ê³µê°„ì´ ë¶€ì¡±í• ë•Œ ë²„í¼ì˜ í¬ê¸°ë¥¼ ìœ ì—°í•˜ê²Œ ëŠ˜ë ¤ ì €ì¥í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ê°’ì´ ë³€ê²½ë ë•Œ `String` ê°ì²´ì™€ ê°™ì´ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì§€ ì•Šê³  ê¸°ì¡´ ê°ì²´ë‚´ì—ì„œ ë¬¸ìì—´ì˜ í¬ê¸°ë¥¼ ë³€ê²½í•˜ê¸° ë•Œë¬¸ì— ë¬¸ìì—´ì˜ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí• ë•Œ ì‚¬ìš©í• ë•Œ ì´ì ì´ ìˆë‹¤.

ë‘ í´ë˜ìŠ¤ëŠ” ëª¨ë‘ ê°™ì€ ë©”ì†Œë“œë¥¼ ê°€ì§€ê³  ìˆëŠ”ë° í•œê°€ì§€ ì°¨ì´ì ì´ ìˆë‹¤ `StringBuffer`ëŠ” ë©€í‹° ì“°ë ˆë“œì— ì•ˆì „í•˜ê³  ,  `StringBuilder`ì€ ë©€í‹°ì“°ë ˆë“œì— ì•ˆì „í•˜ì§€ ì•Šë‹¤.

## 2.1 StringBuffer

`StringBuffer`ì€ ë©€í‹°ì“°ë ˆë“œì— ì•ˆì „í•˜ë‹¤. thread-safeí•˜ë‹¤.  ê° ë©”ì„œë“œë³„ë¡œ `synchronized` í‚¤ì›Œë“œê°€ ì¡´ì¬í•˜ì—¬ ë™ê¸°í™”ê°€ ë³´ì¥ë˜ì–´ìˆë‹¤. ì¦‰, ì´ ë§ì€ ì“°ë ˆë“œê°€ ì§„í–‰ì¤‘ì¸ ì‘ì—…ì„ ë‹¤ë¥¸ ì“°ë ˆë“œê°€ ê°„ì„­í•˜ì§€ ëª»í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

## 2.2 StringBuilder

`StringBuilder`ëŠ” `StringBuffer`ì™€ëŠ” ë‹¤ë¥´ê²Œ ë©€í‹°ì“°ë ˆë“œì— ì•ˆì „í•˜ì§€ ì•Šë‹¤. í•˜ì§€ë§Œ ë‹¨ì¼ì“°ë ˆë“œ í™˜ê²½ì—ì„œëŠ” ì†ë„ê°€ ë” ë¹ ë¥´ê²Œ ë•Œë¬¸ì— ë™ê¸°í™”ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠëŠ” í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
ê·¸ë¦¬ê³  `StringBuilder`ì˜ ê°ì²´ëŠ” `String` ì²˜ëŸ¼ `String constant pool`ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  `heap` ì˜ì—­ì— ì €ì¥ëœë‹¤.

ê·¸ë ‡ë‹¤ë©´ `StringBuilder`ì€ ì—°ì‚°í• ë•Œ ì–´ë–»ê²Œ ë™ì ìœ¼ë¡œ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ê³  `String`ë³´ë‹¤ ë¹ ë¥¼ê¹Œ?

### ë™ì‘ ì›ë¦¬

**`StringBuilder`ì€ ë‚´ë¶€ì ìœ¼ë¡œ `ArrayList`ì™€ ê°™ì€ ì›ë¦¬ë¡œ í¬ê¸°ê°€ ë™ì ìœ¼ë¡œ ëŠ˜ì–´ë‚œë‹¤.**

```java
StringBuilder sb = new StringBuilder("Hello"); 
System.out.println(sb.capacity()); //21
```

ê¸°ë³¸ì ìœ¼ë¡œ `StringBuilder` ê°ì²´ ìƒì„± ì‹œ ë‚´ë¶€ì ìœ¼ë¡œ `default capacity`ê°€  `16 bytes`ì˜ ë²„í¼ í¬ê¸°ë¥¼ ê°€ì§„ë‹¤. ë”°ë¼ì„œ `16 + 5`í•´ì„œ `21`ì˜ ìš©ëŸ‰ì„ ê°€ì§„ë‹¤.

```java
sb = sb.append("World"); 
System.out.println(sb.capacity()); //21
```

ë§Œì•½ í•´ë‹¹ `StringBuilder`ì— í¬ê¸°ê°€ `5`ì¸ ë¬¸ìì—´ì„ ì¶”ê°€í•´ë„ ìš©ëŸ‰ì€ ê·¸ëŒ€ë¡œ `21`ì´ë‹¤. ì´ëŠ” `StringBuilder`ì´ ê¸°ì¡´ ë‚¨ì€ ìš©ëŸ‰(= `16`)ì„ ì‚¬ìš©í–ˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´ ë§Œì•½ì— `16` ì´ìƒì˜ ë¬¸ìì—´ì„ ë”í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

```java

sb = sb.append("WorldWorldWorldhh"); //ê¸¸ì´ê°€ 17ì¸ ë¬¸ìì—´ì„ ë”í•¨
System.out.println(sb.capacity()); //44
```

ì´ë•ŒëŠ” ë‚¨ì€ ìš©ëŸ‰ì¸ 16ì„ ë„˜ì–´ê°€ `(ê¸°ì¡´ ìš©ëŸ‰ í¬ê¸° + 1) * 2` ì¦‰ `(21 +1) * 2 = 44`ì˜ ìš©ëŸ‰ì„ ê°€ì§„ ë¬¸ìì—´ì´ëœë‹¤.

ì¦‰ `StringBuilder`ì€ `ArrayList`ì²˜ëŸ¼ ê°–ê³ ìˆëŠ” ë²„í¼ ìš©ëŸ‰ì´ ì°¼ì„ ë•Œ ìƒˆë¡œìš´ ìš©ëŸ‰ì˜ í¬ê¸°ë¥¼ ëŠ˜ë ¤ ìƒˆë¡œìš´ ê³µê°„ì— í• ë‹¹í•˜ëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ë‹¤ìŒì€ `JDK16`ì˜ `StringBuilder` ì½”ë“œì´ë‹¤.

```java
@IntrinsicCandidate
    public StringBuilder() {
        super(16); //default caapcity
  }

AbstractStringBuilder(int capacity) {
        if (COMPACT_STRINGS) {
            value = new byte[capacity];
            coder = LATIN1;
        } else {
            value = StringUTF16.newBytesFor(capacity);
            coder = UTF16;
        }
    }
```

`StringBuilder` ìƒì„± ì‹œ ìš©ëŸ‰ì´ `16`ì¸ `byte ë°°ì—´`ì´ ë‚´ë¶€ì ìœ¼ë¡œ ìƒì„±ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

```java
public AbstractStringBuilder append(String str) {
        if (str == null) {
            return appendNull();
        }
        int len = str.length();
        ensureCapacityInternal(count + len); 
        putStringAt(count, str);
        count += len;
        return this;
    }
```

```java
/**
     * For positive values of {@code minimumCapacity}, this method
     * behaves like {@code ensureCapacity}, however it is never
     * synchronized.
     * If {@code minimumCapacity} is non positive due to numeric
     * overflow, this method throws {@code OutOfMemoryError}.
     */
    private void ensureCapacityInternal(int minimumCapacity) {
        // overflow-conscious code
        int oldCapacity = value.length >> coder;
        if (minimumCapacity - oldCapacity > 0) {
            value = Arrays.copyOf(value, //valueëŠ” byte[], ìƒˆë¡œë§Œë“  byte[]ì— ë³µì‚¬í›„ ë¦¬í„´
                    newCapacity(minimumCapacity) << coder);
        }
    }
```

ê·¸ë¦¬ê³  `append()`ë©”ì†Œë“œ í˜¸ì¶œ í–ˆì„ ë•Œ `minimumCapacity- oldCapacity` ì´ 0ë³´ë‹¤ í´ë•Œ ì¦‰, `minimumCapacity (count + ìƒˆë¡œìš´ ë¬¸ìì—´ì˜ ê¸¸ì´)` ê°€ ê¸°ì¡´ì˜ `byte[]`ì˜ ê¸¸ì´ë³´ë‹¤ ê¸¸ë‹¤ë©´ ê¸°ì¡´ `byte[]`ì— ì¶”ê°€í•˜ì§€ ëª»í•˜ê³  ìƒˆë¡œìš´ `byte[]`ë§Œë“¤ì–´ì•¼í•˜ë‹ˆ `(ê¸°ì¡´ìš©ëŸ‰ í¬ê¸° + 1) * 2`ë°°ì˜ ìš©ëŸ‰ì˜ `byte[]`ì„ ë§Œë“¤ì–´ ë³µì‚¬í•œë‹¤.

- `Arrays.copyOf(ì›ë³¸ë°°ì—´, ë³µì‚¬í• ê¸¸ì´)` : ì›ë³¸ ë°°ì—´ì„ 0ë¶€í„° ì›í•˜ëŠ” ê¸¸ì´ë§Œí¼ ë³µì‚¬í•œë‹¤.
- `count` : í˜„ì¬ `byte[]`ì˜ ì‚¬ì´ì¦ˆ
- `miminumCapacity`: ìµœì†Œí•œìœ¼ë¡œ í•„ìš”í•œ ìš©ëŸ‰,
- `oldCapacity` : ê¸°ì¡´ ìš©ëŸ‰í¬ê¸°

# 3. ì •ë¦¬

![string](https://github.com/princenim/TIL/assets/59499600/c8b0bcea-6ba6-4950-9f81-7e93d24181f6)


ì¦‰ ìœ„ì˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì„ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

- `String` : ë¬¸ìì—´ ì—°ì‚°ì´ ì ê³ , ë©€í‹°ì“°ë ˆë“œí™˜ê²½ì¼ ê²½ìš°
- `StringBuffer` : ë¬¸ìì—´ ì—°ì‚°ì´ ë§ê³  ë©€í‹°ì“°ë ˆë“œ í™˜ê²½ì¼ ê²½ìš°
- `StringBuilder` : ë¬¸ìì—´ ì—°ì‚°ì´ ë§ê³  ë‹¨ì¼ì“°ë ˆë“œì´ê±°ë‚˜ ë™ê¸°í™”ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ”ê²½ìš°