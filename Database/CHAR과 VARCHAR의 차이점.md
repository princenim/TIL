
# 📌 CHAR과 VARCHAR의 차이

`char`과 `varchar`모두 문자열을 표현할 때 사용하는 자료형으로 `char은 고정형 문자열` `varchar은 가변형 문자열`이다.

`CHAR(N)`과 `VARCHAR(N)`에서 의미하는건 바이트가 아니라 문자의 개수이다. 참고로 `UTF-8`에서 한글은 `3바이트`로 인코딩, `UTF-16`에서 한글은 `2바이트`로 인코딩된다.

| 자료형 | 최대길이 |
| --- | --- |
| **CHAR** | 0~255 |
| **VARCHAR** | 0 ~ 65,535 |

## 1.1 CHAR

`CHAR`은 `고정형 문자열`로 `CHAR(20)` 로 선언하면 총 20자의 문자을 저장할 수있다.  총 `0~255` 까지 사용할 수있으며 `utf8mb4` 문자집합을 사용하는 경우 한글문자는 한 글자당 `3byte`를 차지하므로 총 `60 byte`를 차지한다.  특이점은 사용한 문자열 외에 나머지 바이트는 모두 공백으로 채워진다. 따라서 ‘AA’ 와 ‘AA ’ 를 같다고 판단한다.

길이가 항상 일정하므로 데이터의 크기를 예측하기 쉬우나 가변 길이 문자열에 비해 저장 공간을 낭비할 수 있다는 단점이 존재한다.

## 1.2 VARCHAR

`VARCHAR`은 `가변형 문자열`로 데이터의 길이에 따라 가변적으로 길이가 정해진다. 만약 `VARCHAR(20)`선언되어도  만약에 “`HELLO`”라는 문자열을 저장하면 데이터의 크기인 5byte와 데이터의 길이를 저장하기 위한 `1byte`의 추가공간 총 `6byte`의 공간을 차지한다.

주요 장점은 필요한 공간만 사용하기 때문에 저장공간을 절약할수있다. 하지만  `update`와 `insert`시에 데이터의 길이를 확인하는 추가적인 연산을 해야한다. 하지만 이는 아주 미세한 속도차이므로 거의 느낄수 없다.

또한 기존보다 더 큰 데이터를 저장한다면 새로운 저장영역을 새로 할당해야하므로 데이터 파편화가 일어난다. 따라서 파편화를 염두해둔다면 `VARCHAR`보다 `CHAR`를 사용하고 이와같이 `CHAR`타입으로 동작하도록 강제지정해야한다.

```sql
ALTER TABLE {테이블 이름} ROW_FORMAT = FIXED;
```

## 1.3 CHAR과 VARCHAR을 언제 사용할까?

고정길이의 데이터인 경우 CHAR, 가변길이의 데이터인 경우 `VARCHAR`을 사용하는 것이 좋다. 또한 검색 및 정렬 성능이 필요한 경우 고정된 길이를 갖고있어 일관된 성능을 제공하는 `CHAR`을 사용하는 것이 좋다.