# 📌 Heap과 Priority Queue

# 1. Priority Queue(우선순위 큐)

`큐`는 가장 먼저 삽입한 데이터를 먼저 삭제하는 자료구조인데, `우선순위 큐`는 우선 순위가 가장 높은 데이터를 먼저 삭제하는 자료구조이다. 이러한 `우선순위 큐`는 데이터를 우선순위에 따라 처리하고 싶을때 사용한다. 예를 들어 여러개의 물건 데이터를 자료구조에 넣었다가 가치가 높은 물건 데이터부터 꺼내서 확인해야하는 경우에 우선순위큐를 사용하면 좋다.

# 2. heap(힙)

`힙`은 **`우선순위 큐`를 구현하기 위하여 사용하는 자료구조 중 하나다**. **여러 개의 데이터 중에서 최대값 혹은 최솟값을 빠르게 찾기위해 만들어진 자료구조이므로 우선순위 큐을 구현**하기에 알맞다.

힙은 항상 `완전 이진 트리`이며, 완전 이진 트리는 마지막 레벨을 제외하고 항상 모든 레벨이 완전히 채워져 있다. 그리고 힙에는 `최소 힙` , `최대힙` 이 두 종류가 있다.

![heap](https://github.com/princenim/TIL/assets/59499600/9c8c258a-b943-4669-8c54-9fb028600399)

`최대힙`은 부모 노드의 키 값이 자식 노드의 키 값보다 작거나 같은 완전 이진 트리를 말하며, `최소힙`은 부모 노드의 값이 자식 노드의 값보다 작거나 같은 완전 이진트리를 말한다. `최소힙`을 이용하는 경우 ‘값이 낮은 데이터가 먼저 삭제’되며 `최대힙`을 이용하는 경우 ‘값이 큰 데이터가 먼저 삭제’된다.

언급했듯이  `우선순위 큐`를 구현하는 방법은 다양한데  단순히 `배열`을 이용할수도있다. `배열`의 경우 삭제할때마다 모든 원소를 확인해 우선순위가 가장 높은 것을 찾아야하므로 최악의 경우 `O(N)`이 시간이 소요된다. 하지만 `힙`이라면, 삽입할때 `O(logN)`의 연산을 N번 반복, 삭제할때도 `O(lonN)`연산을 N번 반복하므로 전체 연산횟수는 `2NlogN`으로 빅오 표기법에 따라 전체 시작복잡도는 `O(NlogN)`이 된다.

| 우선순위 큐 구현방식 | 삽입시간 | 삭제시간 |
| --- | --- | --- |
| 배열 | O(1) | O(N) |
| 힙 | O(logN) | O(logN) |

따라서 우선순위 큐는 최소힙 또는 최대힙을 사용하여 구현되어있기때문에 가장 최대값 또는 최소값을 빠르게 구할수있다.

## 2.1 삽입
`최대힙`일때 구현 과정은 다음과 같다.

힙에 삽입 또는 삭제가 일어날때 최대힙의 조건이 깨진다. 이때 최대힙의 조건에 만족할 수있게 노드들의 위치를 다시 바꾸는데 이를 `힙의 재구조화(heapify)`라고 한다. 따라서 삽입, 삭제 시 시간복잡도는 `O(logN)` 이다.
[HashMap은 어떻게 동작할까?.md](..%2FJava%2FHashMap%EC%9D%80%20%EC%96%B4%EB%96%BB%EA%B2%8C%20%EB%8F%99%EC%9E%91%ED%95%A0%EA%B9%8C%3F.md)
![heap1](https://github.com/princenim/TIL/assets/59499600/333ea629-213b-4609-9c6b-d3b52947ccdc)

## 2.2 삭제

![Heap2](https://github.com/princenim/TIL/assets/59499600/f9458a7e-bd76-48e8-9e44-4cc2e28be7f2)

참고 영상 : https://www.youtube.com/watch?v=jfwjyJvbbBI

## 2.2 최대힙을 활용한 작은 숫자 선택 방법

**Q.  1억개의 숫자가 있고 그중에서 작은 10만개의 숫자를 뽑고 싶어 어떻게 뽑아야 할까? 시간복잡도와 메모리 사용량을 구하라.**

위의 방법에서 최대힙을 사용할 수 있다. 방법은 다음과 같다.

1. 최대 힙의 크기를 10만으로 설정한다.
2. 10만개의 숫자를 최대힙에 삽입한다. 이때 시간복잡도가 `O(10만 * log N)`
3. 이제 나머지 숫자를 돌면서 루트보다 값이 작을때, 기존 루트 값을 삭제하고 새로운 숫자를 넣어 다시 최대힙의 정렬을 수행하면 최대힙에는 10만개의 작은 숫자들만 저장이 된다. 이때 시간복잡도가  `O((N - 10만) * log N)` 이다.

이렇게 구현하면 메모리 사용량은 자바에서 int가 4byte 즉 32bit이므로 10만개의 숫자를 저장하면 `10만 * 4byte= 40만 byte`이다.