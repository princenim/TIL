# **ðŸ“Œ**Â CORS(Cross Origin Resource Sharing)

# 1. Origin

ë¨¼ì € `CORS` ì„ ì•Œê¸°ì „ì— `Origin`ì„ ì•Œì•„ë³´ìž. `Origin`ì´ëž€ ì¶œì²˜ë¼ëŠ” ëœ»ìœ¼ë¡œ `URL`ì—ì„œ `í”„ë¡œí† ì½œ`, `ë„ë©”ì¸`, `í¬íŠ¸ë²ˆí˜¸`ë¥¼ í•©ì¹œ ë¶€ë¶„ì„ ì˜ë¯¸í•œë‹¤.

ì¦‰,  `https://hazel.com:80/posts/123456?data=789#abc` ì´ëŸ° URLì´ ì¡´ìž¬í•œë‹¤ë©´ `https://it-eldorado.com:80` ì´ ë¶€ë¶„ì´ `Origin`ì´ë‹¤.

# 2. SOP(Same Origin Policy)

`SOP`ëŠ” `ë™ì¼ ì¶œì²˜ ì •ì±…`ì´ë¼ëŠ” ëœ»ìœ¼ë¡œ ê°™ì€ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë§Œ ìƒí˜¸ìž‘ìš©ì„ í—ˆìš©í•˜ëŠ” ì •ì±…ì´ë‹¤. ì´ ì •ì±…ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì›¹ ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ ì¡´ìž¬í•œë‹¤.

ë§Œì•½ì— SOPê°€ ì—†ì—ˆë‹¤ë©´ ëª¨ë“  ì¶œì²˜ì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ê³  ì™¸ë¶€ì„œë²„ê°€ ì•…ì˜ì ìœ¼ë¡œ ì ‘ê·¼í•´ ì¡°ìž‘í•  ê°€ëŠ¥ì„±ì´ ìžˆë‹¤. ë”°ë¼ì„œ SOPëŠ” ê°™ì€ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ì„œë§Œ APIìš”ì²­ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê³ , ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ì— ì „ê¸‰í•˜ê¸° ìœ„í•´ì„œëŠ” ì¶”ê°€ì ì¸ ë§¤ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ í•˜ì˜€ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ë„ë©”ì¸ Aì—ì„œ ì‹¤í–‰ì¤‘ì¸ ì½”ë“œëŠ” ë‹¤ë¥¸ ë„ë©”ì¸ Bì— ìœ„ì¹˜í•œ ë¦¬ì†ŒìŠ¤ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìžˆë‹¤.

# 3. CORS(Cross Origin Resource Sharing)

`SOP`ë¡œ ì¸í•´ ë‹¤ë¥¸ ì¶œì²˜ì˜ ìžì›ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ëŠ” ì•…ì˜ì ì¸ ìš”ì²­ì„ ë§‰ì„ ìˆ˜ ìžˆë‹¤ëŠ” ìž¥ì ì´ ìžˆì§€ë§Œ ìœ íš¨í•œ ìš”ì²­ë˜í•œ ë§‰ì•„ë²„ë¦°ë‹¤ëŠ” ë‹¨ì ì´ìžˆë‹¤. ì›¹ í™˜ê²½ì€ ê°œë°©ì ì´ê³  ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì™€ì„œ ì‚¬ìš©í•˜ëŠ” í–‰ìœ„ìžì²´ë¥¼ ë§‰ì•„ë²„ë¦¬ë©´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ë™ìž‘í•˜ê¸° íž˜ë“¤ë‹¤. ë”°ë¼ì„œ ì¶œì²˜ê°€ ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë„ë¡ í•˜ëŠ” ëª‡ê°€ì§€ ì˜ˆì™¸ ì¡°í•­ì´ ìžˆëŠ”ë° ê·¸ì¤‘ í•˜ë‚˜ê°€ ë°”ë¡œ CORS ì •ì±…ì„ ì§€í‚¨ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì´ë‹¤.

`CORS`ëŠ” `Cross Origin Resource Sharing`ì˜ ì•½ìžë¡œ `êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ `ë¥¼ ë§í•œë‹¤.

ë™ìž‘ ì›ë¦¬ëŠ” ë‹¨ìˆœí•˜ë‹¤. ë¸Œë¼ìš°ì €ëŠ” ë‹¤ë¥¸ `Origin` ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ `Origin` í—¤ë”ì— ìžì‹ ì˜ `Origin`ì„ ì„¤ì •í•˜ê³ , ì„œë²„ë¡œë¶€í„° ì‘ë‹µì„ ë°›ìœ¼ë©´ ì‘ë‹µì˜ `Access-Control-Allow-Origin`í—¤ë”ì— ì„¤ì •ëœ `Origin`ì˜ ëª©ë¡ì— ìš”ì²­ì˜ `Origin` í—¤ë” ê°’ì´ í¬í•¨ë˜ì–´ìžˆëŠ”ì§€ ê²€ì‚¬í•œë‹¤.

ë” ìžì„¸í•˜ê²Œ ì„¤ëª…í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì¶œì²˜ê°€ ë‹¤ë¥¸ ê³³ì— ìš”ì²­ì„ í• ë•Œ ìš”ì²­ í—¤ë”ì— `Origin` ì´ë¼ëŠ” í•„ë“œë¥¼ í•¨ê»˜ ë³´ë‚¸ë‹¤. ( `https://www.google.com` â†’ `https://my-server.com` ë¡œ ìš”ì²­ )

```java
// Origin : https://www.google.com
```

ì˜ˆë¥¼ ë“¤ì–´, ì¶œì²˜ê°€Â `https://my-server.com`ì¸ ì„œë²„ì—ì„œÂ `https://www.google.com`Â ë¡œ ë¶€í„° ì˜¤ëŠ” ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ í—ˆìš©í•˜ê³ ìž í•œë‹¤ë©´, ì‘ë‹µ í—¤ë”ì—Â `Access-Control-Allow-Origin: https://www.google.com`Â ì„ ì„¤ì •í•˜ì—¬ ì‘ë‹µí•œë‹¤. ê·¸ë¦¬ê³  ì‘ë‹µì„ ë°›ì€ ë¸Œë¼ìš°ì €ëŠ” ìžì‹ ì´ ë³´ëƒˆë˜ ìš”ì²­ì˜ `Origin`ê³¼ ì„œë²„ ì‘ë‹µì˜ `Access-Control-Allow-Origin` ê°’ì´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ì¼ì¹˜í•˜ë©´ ì¶œì²˜ê°€ ë‹¬ë¼ë„ ìœ íš¨í•œ ìš”ì²­ì´ë¼ê³  íŒë‹¨í•´ ë°›ì•„ì˜¨ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.

## 3.1 CORS ì—ëŸ¬

`CORS ì—ëŸ¬`ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¡œ `CORS` ì •ì±… ìœ„ë°˜ì‹œì— ë‚˜íƒ€ë‚œë‹¤. ì´ ì—ëŸ¬ëŠ” í”„ë¡ íŠ¸ì™€ ë°±ì—”ë“œë¡œ ë‚˜ëˆ„ì–´ ê°œë°œí•  ê²½ìš° í”ížˆ ë‚˜íƒ€ë‚˜ëŠ”ë° Springì„ ì‚¬ìš©í•´ `CORS` ì—ëŸ¬ë¥¼ í•´ê²°í•  ìˆ˜ ìžˆë‹¤.

### **@CrossOrgin() ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©**

í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ í´ëž˜ìŠ¤ë‚˜ ë©”ì†Œë“œì— ë¶™ì´ë©´ í•´ë‹¹ í´ëž˜ìŠ¤ì™€ ë©”ì†Œë“œëŠ” `CORS`ë¥¼ í—ˆìš©í•œë‹¤.

### Spring Security ì—ì„œ CORS ì„¤ì •

`Spring security`ë¥¼ ì‚¬ìš©í•˜ë©´ ëª¨ë“  ì™¸ë¶€ ìš”ì²­ì— ëŒ€í•´ `CORS`ë¥¼ `Block`í•œë‹¤ ë”°ë¼ì„œ `CORS`ì— ëŒ€í•œ ì„¤ì •ì„ ì»¤ìŠ¤í…€í•´ì•¼í•œë‹¤.  `SecurityFilterChain`ì„ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í• ë•Œ `CORS`ì™€ ê´€ë ¨ëœ ì„¤ì •ì„ í•  ìˆ˜ ìžˆë‹¤.

```java

//spring boot 3ì ëŒ€ 
public class SecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity httpSecurity) throws Exception {
        httpSecurity.cors(corsCustomizer -> corsCustomizer.configurationSource(request -> {
            CorsConfiguration config = new CorsConfiguration();
            config.setAllowedOrigins(Arrays.asList(
                    "http://localhost:3000",
										"etc.."
            ));
            config.setAllowedMethods(Collections.singletonList("*"));
            config.setAllowCredentials(true);
            config.setAllowedHeaders(Collections.singletonList("*"));
            config.setMaxAge(3600L);
            return config;
        }));
}
```