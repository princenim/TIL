
# *📌* XSS와 CSRF 특징 및 차이점

# 1.  XSS (Cross-Site Scripting)

`크로스 사이트 스크립팅`은 `SQL injection`과 함께 가장 웹 상에서 기초적인 취약점 공격 방법의 일종으로 **악의적인 사용자가 공격하려는 사이트에 스크립트를 넣는 기법을 말한다.** 주로 다른 웹사이트와 정보를 교환하는 식으로 작동하므로 사이트 간 스크립팅이라고 한다.

이 취약점은 웹 어플리케이션이 사용자로부터 입력받은 값을 제대로 검사하지않고 사용할 경우 나타나며 공격에 성공하면 사이트에 접속한 사용자는 삽입된 코드를 실행한다. 보통 쿠키나 세션 등의 민감한 정보를 탈휘한다.

공격방법에 따라 `Stored XSS`와 `Reflected XSS`로 나뉜다.

- `Stored XSS`는 사이트 게시판이나 댓글, 닉네임 등 스크립트가 서버에 저장되어 실행되는 방식이다.
- `Reflected XSS` 는 URL 파라미터에 스크립트를 넣어 서버에 저장하지 않고 그 즉시 스크립트를 만드는 방식이다.

## 1.1 방지 대책

1. **입력 데이터 검증** : 사용자로부터 받은 입력 데이터를 검증하고 필터링해 허용되지 않는 스크립트가 포함되어있는지 확인한다. 형식, 길이를 검증할 수 있다.
2. **HTTP Only 쿠키 사용** : 민감한 정보를 담고 있는 쿠키에는 HTTP Only 쿠기를 사용해 자바스크립트에서 접곤할 수 없도록 한다.
3. **보안 헤더 설정** : 웹 애플리케이션에서는 적절한 보안 헤더를 설정하여 보안을 강화할 수 있다. 예를 들면 `X-Content-Type-Options`, `X-Frame-Options`, `X-XSS-Protection` 등의 헤더를 사용할 수 있다

# 2. CSRF(Cross-Site Request Forgery attack)

`사이트 간 요청 위조`는 웹 사이트 취약점 공격의 하나로 **사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위(수정, 삭제,등록)을 특정 웹 사이트에 요청하게 하는 공격을 말한다.**

`CSRF`는 특정 웹 사이트가 사용자의 웹 브라우저를 신용하는 상태를 노린것이다. 사용자가 웹 사이트에 로그인한 상태에서 사이트간 요청 위조코드가 삽입된 페이지를 열면 공격대상이 되는 웹 사이트는 위조된 공격 명령이 믿을 수 있는 사용자로부터 발송된 것으로 판단해 공격해 노출된다.

즉 공격자가 사용자의 컴퓨터를 감염시키거나 사이트 해킹을 해서 이뤄지는 공격이 아니므로 다음과 같은 조건을 만족해야한다.

1. 위조 요청을 전송하는 서비스(e.g. 페이스북)에 희생자가 로그인 상태여야한다.
2. 희생자는 공격자가 만든 피싱 사이트에 접속해야한다.

## 2.2 방지 대책

1. **CSRF 토큰 사용**: 모든 중요한 요청에는 서버에서 생성한 `CSRF 토큰`을 포함시켜야한다.따라서 사용자는 웹 페이지에 폼을 제출할때마다 이를 제출해야하며 서버는 이를 확인하고 유효하지 않으면 요청을 거부한다. `Spring Security`는 `CSRF 토큰` 생성을 지원하는 기능을 제공한다.
2. **SameSite 쿠키 속성 사용** : 최신 브라우저에는 `SameSite` 쿠키 속성을 지원한다. `SameSite` 속성을 `Strict` 또는 `Lax`로 설정하면, 요청이 같은 사이트에서 이뤄지는 경우에만 쿠키가 함께 전송된다.
3. **Referrer 검증** : 서버에서는 요청의 `Referrer` 헤더를 검증해 요청이 자신의 도메인에서 온 것인지 확인할 수 있다. 하지만 `Referrer` 헤더는 항상 신뢰할 수 없으므로 단독으로 사용하기 보다 다른 방법과 사용하는 것이 좋다.

# 3. XSS와 CSRF의 차이

`XSS`와 `CSRF` 모두 사용자의 브라우저를 대상으로 한다는 공통점이 있다. 하지만 `XSS`는 인증된 세션 없이도 공격을 진행할 수 있고, `CSRF`는 사용자의 인증된 세션을 사용하여 공격을 한다. 그리고 `XSS`는 사용자가 특정 사이트를 신뢰한다는 사실을 이용한 공격방식이지만, `CSRF`는 웹 어플리케이션이 인증된 사용자의 요청을 신뢰한다는 사실을 이용한 공격방식이다.